<html>
    <head>
        <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

        <title>Trackmania Gold Times</title>

        <script src="tmdata.js"></script>
        <script src="colorparser.trackmania.js"></script>

        <style>
            body {
                background-color: #555;
                color: #aaa;
            }
            td, th {
                text-align: center;
                vertical-align: middle !important;
            }
            .tmtable {
                width: 80%;
                margin-left: auto;
                margin-right: auto;
                font-size: 18px;
            }
        </style>

    </head>
    <body>
        <br />
        <h2 style="text-align: center;">TOTD</h2>
        <br />
        <table class="tmtable table table-striped table-dark table-hover" >
            <thead>
                <th>day</th>
                <th style="text-align: left;">map</th>
                <th>gold time</th>
                <th>gold rank</th>
                <th>players</th>
                <th>gold ratio</th>
            </thead>
            <tbody id="totd_tbody"></tbody>
        </table>

        <!-- <br />
        <h2 style="text-align: center;">Campaign</h2>
        <br />
        <table class="tmtable table table-striped table-dark table-hover" >
            <thead>
                <th>#</th>
                <th style="text-align: left;">map</th>
                <th>gold time</th>
                <th>gold rank</th>
                <th>players</th>
                <th>gold ratio</th>
            </thead>
            <tbody id="camp_tbody"></tbody>
        </table> -->

    <script>

        function getColor(value){
            //value from 0 to 1
            var hue=((value)*120).toString(10);
            return ["hsl(",hue,",100%,50%)"].join("");
        }

        function fillTable(tbody, tminfo) {

            for (const d in tminfo) {
                let info = tminfo[d];
                let tr = document.createElement("tr");
                let name_f = COLORPARSER.toHTML(info['name']);
                let img_f = "<img src='" + info['thumbnailUrl'] + "' style='width: 40px; margin-right: 15px;' />";
                let time_f = new Date(info['goldTime']).toISOString().slice(14,23);
                let ratio_f = parseInt(100*info['goldPosition']/info['lastPosition'])+"&nbsp;%";
                let ratio_col = getColor(info['goldPosition']/info['lastPosition']) ;
                let ratio_td = "<td style='color: " + ratio_col + "'>" + ratio_f + "</td>";
                tr.innerHTML = `<td>${d}</td><td style='text-align: left;'>${img_f}${name_f}</td><td>${time_f}</td><td>${info['goldPosition']}</td><td>${info['lastPosition']}</td>${ratio_td}`
                tbody.appendChild(tr);
            }

        }

        fillTable(document.getElementById("totd_tbody"), totd_info);
        // fillTable(document.getElementById("camp_tbody"), camp_info);


    </script>
    </body>
</html>
